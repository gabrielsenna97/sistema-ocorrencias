<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Formulário AppSheet</title>
</head>
<body>
  <h2>Enviar dados + foto</h2>
  <input type="text" id="nome" placeholder="Nome"><br><br>
  <input type="email" id="email" placeholder="Email"><br><br>
  <input type="file" id="foto"><br><br>
  <button onclick="enviarDados()">Enviar</button>

  <script>
    let fotoBase64 = '';

    // Converter foto para base64
    document.getElementById('foto').addEventListener('change', function() {
      const file = this.files[0];
      const reader = new FileReader();
      reader.onload = function() {
        fotoBase64 = reader.result.split(',')[1]; // pega só os dados
      };
      reader.readAsDataURL(file);
    });

    function enviarDados() {
      const dados = {
        nome: document.getElementById('nome').value,
        email: document.getElementById('email').value,
        foto: fotoBase64
      };

      fetch('https://script.google.com/macros/s/AKfycbzX1AXXfCMYUE-QDr2JzOY-QkKJxAPrXjVr1KZAupQYrvoU_U0jCkZmYIj5xsRSWSi1pg/exec', {
        method: 'POST',
        body: JSON.stringify(dados),
        headers: {
          'Content-Type': 'application/json'
        }
      })
      .then(res => res.json())
      .then(resp => {
        if(resp.status === 'ok') {
          alert('Enviado com sucesso!\nURL da foto: ' + resp.url);
        } else {
          alert('Erro: ' + resp.message);
        }
      })
      .catch(err => alert('Erro de envio: ' + err));
    }
  </script>
</body>
</html>
